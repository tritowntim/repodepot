console.log("lookup...")

var n = "<%=  j (render :partial => 'condensed', :locals => {:repository => @repository, :commentary => nil}) %>"
var repositoryId = "<%= @repository.id %>"

var time = new Date().getTime()
var b = $("#blank-listing").html()
var regexp = new RegExp($(b).data('id'),'g')
$('#listing-forms').append($("#blank-listing").html().replace(regexp,time))
// console.log("BY ID = " + $("#" + time + " form").html())

// todo: cleanup this insertion/reference
$("form","#" + time).parent().after(n)
$("form","#" + time).parent().remove()

// todo: better way to reference, like ordering below?
$("#list_listings_attributes_" + time + "_repository_id").val(repositoryId)

$('#'+time+" .ordering").val($('#listing-forms fieldset').length)

$('.repository-search').toggleClass('invisible-ui')

$('#'+time+" .commentary").focus()
